<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Script Dependency Test</title>
    <style>
        body { font-family: monospace; background: #1a1a1a; color: #fff; margin: 20px; }
        .result { margin: 10px 0; padding: 10px; background: #2a2a2a; border-radius: 3px; }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        .warning { color: #FF9800; }
        .info { color: #2196F3; }
        .script-status { margin: 5px 0; padding: 3px 8px; border-radius: 2px; }
        button { background: #2196F3; color: white; padding: 8px 16px; border: none; border-radius: 3px; cursor: pointer; margin: 5px; }
        button:hover { background: #0b7dda; }
    </style>
</head>
<body>
    <h1>Ì≥ú Script Dependency Test</h1>
    <div id="results" class="result"></div>

    <script>
        const loadOrder = [];

        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const timestamp = new Date().toLocaleTimeString();
            results.innerHTML += `<div class="${type}">[${timestamp}] ${message}</div>`;
            console.log(`[${type.toUpperCase()}] ${message}`);
            
            loadOrder.push({
                time: performance.now(),
                message: message,
                type: type
            });
        }

        log('Ì∫Ä Script dependency test started');

        // Test 1: Check if all expected scripts are loaded
        setTimeout(() => {
            log('Ì¥ç Checking script loading status...', 'info');

            const expectedScripts = [
                { name: 'AppConfig', check: typeof window.AppConfig !== 'undefined' },
                { name: 'EventBus', check: typeof EventBus !== 'undefined' },
                { name: 'FontManager', check: typeof FontManager !== 'undefined' },
                { name: 'ASCIIRenderer', check: typeof ASCIIRenderer !== 'undefined' },
                { name: 'InputValidator', check: typeof InputValidator !== 'undefined' },
                { name: 'ErrorHandler', check: typeof ErrorHandler !== 'undefined' }
            ];

            let loaded = 0;
            expectedScripts.forEach(script => {
                if (script.check) {
                    log(`‚úÖ ${script.name} loaded`, 'success');
                    loaded++;
                } else {
                    log(`‚ùå ${script.name} not loaded`, 'error');
                }
            });

            log(`Ì≥ä Scripts loaded: ${loaded}/${expectedScripts.length}`);

            if (loaded < expectedScripts.length) {
                log('‚ö†Ô∏è Some scripts failed to load - check for syntax errors', 'warning');
            }

        }, 100);

        // Test 2: Check for dependency issues
        setTimeout(() => {
            log('Ì¥ó Checking for dependency issues...', 'info');

            // Check if classes can be instantiated
            try {
                if (typeof EventBus !== 'undefined') {
                    const eventBus = new EventBus();
                    if (eventBus) {
                        log('‚úÖ EventBus instantiation working', 'success');
                    } else {
                        log('‚ùå EventBus instantiation failed', 'error');
                    }
                }
            } catch (error) {
                log(`‚ùå EventBus instantiation error: ${error.message}`, 'error');
            }

            try {
                if (typeof FontManager !== 'undefined') {
                    const fontManager = new FontManager();
                    if (fontManager) {
                        log('‚úÖ FontManager instantiation working', 'success');
                    } else {
                        log('‚ùå FontManager instantiation failed', 'error');
                    }
                }
            } catch (error) {
                log(`‚ùå FontManager instantiation error: ${error.message}`, 'error');
            }

        }, 200);

        // Test 3: Check for syntax errors in individual scripts
        setTimeout(() => {
            log('Ì¥ç Checking for syntax errors...', 'info');

            // Try to load problematic scripts individually
            const scriptTests = [
                { name: 'config/app.config.js', test: () => typeof window.AppConfig !== 'undefined' },
                { name: 'core/EventBus.js', test: () => typeof EventBus !== 'undefined' },
                { name: 'core/ErrorHandler.js', test: () => typeof ErrorHandler !== 'undefined' },
                { name: 'modules/FontManager.js', test: () => typeof FontManager !== 'undefined' }
            ];

            scriptTests.forEach(({ name, test }) => {
                try {
                    if (test()) {
                        log(`‚úÖ ${name} syntax OK`, 'success');
                    } else {
                        log(`‚ùå ${name} syntax error`, 'error');
                    }
                } catch (error) {
                    log(`‚ùå ${name} error: ${error.message}`, 'error');
                }
            });

        }, 300);
    </script>
</body>
</html>
